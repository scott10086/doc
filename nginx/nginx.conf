nginx配置文件

#user  nobody;
worker_processes  8;   #cpu(取决于cpu的核数，一般为cpu核数或倍数。也可以配置成auto，让nginx自己选择工作线程数)

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;

worker_rlimit_nofile   204800; 
events {
	use epoll;		# Linux下多路复用IO接口select/poll的增强版本，它能显著提高程序在大量并发连接中只有少量活跃的情况下的系统CPU利用率
    worker_connections  204800;	#每一个进程打开的最大连接数，包含了nginx与客户端和nginx与upstream之间的连接（受限于操作系统）
	multi_accept on;	#可以一次建立多个连接
}


http {
    include       mime.types;
	client_max_body_size 20m;
	server_tokens off;				### 隐藏浏览器请求头中 nginx版本信息
    default_type  application/octet-stream;

    log_format main  '访问时间【$time_local】---- 请求【$request】'
					 '代理地址【$upstream_addr】---- 代理响应状态【$upstream_status】';

	log_format ajax '访问时间【$time_local】---- 请求【$request】 '
					'客户端ip地址【$remote_addr】 ---- 客户端端口【$remote_port】'
					'CIP地址【$upstream_addr】---- 代理响应状态【$upstream_status】'
					'处理客户端请求使用时间【$request_time】 $http_cookie';
					
    sendfile        on;
    keepalive_timeout  65;
	
	gzip on;
    gzip_min_length   1k;	# 开始压缩的最小长度
    gzip_buffers     4 16k;	# 缓冲(压缩在内存中缓冲几块? 每块多大?)
    gzip_http_version 1.1;	# 开始压缩的http协议版本(可以不设置,目前几乎全是1.1协议)
    gzip_comp_level 9;		# 推荐6 压缩级别(级别越高,压的越小,越浪费CPU计算资源)
    gzip_types       text/plain text/css application/json application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript;	#对哪些类型的文件用压缩 如txt,xml,html ,css
    gzip_vary on;			# 是否传输gzip压缩标志
	
	upstream cip1 {
	    server 172.16.101.155:8668;
	}
	
	upstream cip2 {
	    server 172.16.101.155:8228;
	}
	
	upstream cip3 {
	    server 172.16.101.155:8758;
	}
	
	upstream cip4 {
	    server 172.16.101.155:8778;
	}
	
	upstream cip5 {
	    server 172.16.101.155:8768;
	}	
	
	# 奇瑞
    server {
        listen       8440;
		client_max_body_size 20m;

		access_log  /home/web/fep-cheryfs/logs/host.access.log  main;

        location / {
            root   /home/web/fep-cheryfs/dist;
			client_max_body_size 20m;
            index  index.html;
        }

        location ~ CIP {
			access_log  /home/web/fep-cheryfs/logs/ajax.access.log  ajax;
            proxy_pass http://cip1;
        }
    }	
	
	# 天津对公营销环境
	server {
		 listen       8110;
		client_max_body_size 200M;
		 
		access_log  /home/web/web_tj_official/logs/all.access.log  main;
		 
		# 门户项目
		 location / {
            proxy_pass http://127.0.0.1:8111/;
        }
		
		# 门户项目
		 location /gateway {
            proxy_pass http://127.0.0.1:8111/;
        }
		 
		 # 静态资源
		 location /assets {
			proxy_pass http://127.0.0.1:8112;
		 }
		 
		 # 静态资源
		 location /scripts.js {
			proxy_pass http://127.0.0.1:8112/scripts.js;
		 }
		 
		 # 静态资源
		 location /styles.css {
			proxy_pass http://127.0.0.1:8112/styles.css;
		 }
		
		# 身份认证代理
		 location /basicsIframe {
            proxy_pass http://127.0.0.1:8113/;
        }
		
		# 客户中心
		 location /customIframe {
            proxy_pass http://127.0.0.1:8114/;
        }
		
		# 产品中心
		 location /productIframe {
            proxy_pass http://127.0.0.1:8115/;
        }
		
		# 工作流
		 location /workflowIframe {
            proxy_pass http://127.0.0.1:8116/;
        }
		
		# other [cip 事件中心 消息中心]
		 location /otherIframe {
            proxy_pass http://127.0.0.1:8117/;
        }

		location ~ CIP {
			access_log  /home/web/web_tj_official/logs/ajax.access.log  ajax;
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
			proxy_http_version 1.1;
			
            proxy_pass http://cip2;
        }		 
	}
	
	# 天津对公营销环境 门户项目
    server {
        listen       8111;

        access_log  /home/web/web_tj_official/logs/gateway.access.log  main;

        location / {
            root   /home/web/web_tj_official/gateway;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 门户静态资源
	server {
		 listen       8112;

		 access_log  /home/web/web_tj_official/logs/static.access.log  main;

		 location / {
			 root   /home/web/web_tj_official/static;
		 }
	}
	
	# 天津对公营销环境 身份认证
    server {
        listen       8113;

        access_log  /home/web/web_tj_official/logs/basics.access.log  main;

        location / {
            root   /home/web/web_tj_official/basics;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 客户中心
    server {
        listen       8114;

        access_log  /home/web/web_tj_official/logs/custom.access.log  main;

        location / {
            root   /home/web/web_tj_official/custom;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 产品中心
    server {
        listen       8115;

        access_log  /home/web/web_tj_official/logs/product.access.log  main;

        location / {
            root   /home/web/web_tj_official/product;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 工作流
    server {
        listen       8116;

        access_log  /home/web/web_tj_official/logs/workflow.access.log  main;

        location / {
            root   /home/web/web_tj_official/workflow;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 其他【CIP  消息中心 事件中心】
    server {
        listen       8117;

        access_log  /home/web/web_tj_official/logs/other.access.log  main;

        location / {
            root   /home/web/web_tj_official/other;
            index  index.html;
        }
    }
	
	# 天津对公营销环境  合版
	server {
		listen       8220;
		client_max_body_size 200M;
		 
		 access_log  /home/web/web_sum/logs/all.access.log  main;
		 
		# 门户项目
		 location / {
            proxy_pass http://127.0.0.1:8221/;
        }
		
		# 门户项目
		 location /gateway {
            proxy_pass http://127.0.0.1:8221/;
        }
		 
		 # 静态资源
		 location /assets {
			proxy_pass http://127.0.0.1:8222;
		 }
		 
		 # 静态资源
		 location /scripts.js {
			proxy_pass http://127.0.0.1:8222/scripts.js;
		 }
		 
		 # 静态资源
		 location /styles.css {
			proxy_pass http://127.0.0.1:8222/styles.css;
		 }
		
		# 身份认证代理
		 location /basicsIframe {
            proxy_pass http://127.0.0.1:8223/;
        }
		
		# 客户中心
		 location /customIframe {
            proxy_pass http://127.0.0.1:8224/;
        }
		
		# 产品中心
		 location /productIframe {
            proxy_pass http://127.0.0.1:8225/;
        }
		
		# 工作流
		 location /workflowIframe {
            proxy_pass http://127.0.0.1:8226/;
        }
		
		# CIP
		 location /configIframe {
            proxy_pass http://127.0.0.1:8227/;
        }

		location ~ CIP {
			access_log  /home/web/web_sum/logs/ajax.access.log  ajax;
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
			
            proxy_pass http://cip3;
        }		 
	}
	
	
	# 天津大零售测试环境 门户 合版
    server {
        listen       8221;

        access_log  /home/web/web_sum/logs/gateway.access.log  main;

        location / {
            root   /home/web/web_sum/gateway;
            index  index.html;
        }
    }
	
	# 天津大零售测试环境 门户静态资源 合版
	server {
		 listen       8222;

		 access_log  /home/web/web_sum/logs/static.access.log  main;

		 location / {
			 root   /home/web/web_sum/static;
		 }
	}
	
	# 天津大零售测试环境 身份认证 合版
    server {
        listen       8223;

        access_log  /home/web/web_sum/logs/basics.access.log  main;

        location / {
            root   /home/web/web_sum/basics;
            index  index.html;
        }
    }
	
	# 天津大零售测试环境 客户中心 合版
    server {
        listen       8224;

        access_log  /home/web/web_sum/logs/custom.access.log  main;

        location / {
            root   /home/web/web_sum/custom;
            index  index.html;
        }
    }
	
	# 天津大零售测试环境 产品中心 合版
    server {
        listen       8225;

        access_log  /home/web/web_sum/logs/product.access.log  main;

        location / {
            root   /home/web/web_sum/product;
            index  index.html;
        }
    }
	
	# 天津大零售测试环境 工作流 合版
    server {
        listen       8226;

        access_log  /home/web/web_sum/logs/workflow.access.log  main;

        location / {
            root   /home/web/web_sum/workflow;
            index  index.html;
        }
    }
	
	# 天津大零售测试环境 CIP 合版
    server {
        listen       8227;

        access_log  /home/web/web_sum/logs/cip.access.log  main;

        location / {
            root   /home/web/web_sum/cip;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目
	server {
		listen       8330;
		client_max_body_size 200M;
		 
		 access_log  /home/web/web_dev/logs/all.access.log  main;
		 
		# 门户项目
		 location / {
            proxy_pass http://127.0.0.1:8331/;
        }
		
		# 门户项目
		 location /gateway {
            proxy_pass http://127.0.0.1:8331/;
        }
		 
		 # 静态资源
		 location /assets {
			proxy_pass http://127.0.0.1:8332;
		 }
		 
		 # 静态资源
		 location /scripts.js {
			proxy_pass http://127.0.0.1:8332/scripts.js;
		 }
		 
		 # 静态资源
		 location /styles.css {
			access_log off;
			proxy_pass http://127.0.0.1:8332/styles.css;
		 }
		
		# 身份认证代理
		location /basicsIframe {
            proxy_pass http://127.0.0.1:8333/;
        }

        # 统一机构代理
		location /resourceIframe {
            proxy_pass http://127.0.0.1:8334/;
        }
			 
		# 交易中心代理
		location /tradeCenterIframe {
            proxy_pass http://127.0.0.1:8335/;
        }
		
		# 产品中心代理
		location /productIframe {
            proxy_pass http://127.0.0.1:8336/;
        }
		
		# 消息中心  事件中心   CIP前端页面代理
		location /otherIframe {
            proxy_pass http://127.0.0.1:8337/;
        }
		
		# 工作流代理
		location /workflowIframe {
            proxy_pass http://127.0.0.1:8338/;
        }

        # 客户中心代理
		location /customIframe {
            proxy_pass http://127.0.0.1:8339/;
        }

        location /workflow-app/{
           proxy_pass http://172.16.101.157:8084/workflow-app/;
		 proxy_cookie_path  /workflow-app /workflow;
        }


		location ~ CIP {
			access_log  /home/web/web_dev/logs/ajax.access.log  ajax;
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
						
            proxy_pass http://cip4;
        }		 
	}
	
	# 研发版本作业平台项目 门户
    server {
        listen       8331;

        location / {
            root   /home/web/web_dev/gateway;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目 静态资源CDN
	server {
		 listen       8332;

		 access_log  /home/web/web_dev/logs/static.access.log  main;

		 location / {
			 root   /home/web/web_dev/static;
		 }
	}
	
	# 研发版本作业平台项目 身份认证
    server {
        listen       8333;

        access_log  /home/web/web_dev/logs/basics.access.log  main;

        location / {
            root   /home/web/web_dev/basics;
            index  index.html;
        }
    }
    
    # 研发版本作业平台项目 身份认证
    server {
        listen       8334;

        access_log  /home/web/web_dev/logs/resource.access.log  main;

        location / {
            root   /home/web/web_dev/resource;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目 交易中心
    server {
        listen       8335;

        access_log  /home/web/web_dev/logs/tradeCenter.access.log  main;

        location / {
            root   /home/web/web_dev/tradeCenter;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目 产品中心
    server {
        listen       8336;

        access_log  /home/web/web_dev/logs/product.access.log  main;

        location / {
            root   /home/web/web_dev/product;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目 消息中心  事件中心   CIP前端维护页面
    server {
        listen       8337;

        access_log  /home/web/web_dev/logs/other.access.log  main;

        location / {
            root   /home/web/web_dev/other;
            index  index.html;
        }
    }
	
	# 研发版本作业平台项目 工作流页面
    server {
        listen       8338;

        access_log  /home/web/web_dev/logs/workflow.access.log  main;

        location / {
            root   /home/web/web_dev/workflow;
            index  index.html;
        }
        
    }

    # 研发版本作业平台项目 客户中心页面
    server {
        listen       8339;

        access_log  /home/web/web_dev/logs/custom.access.log  main;

        location / {
            root   /home/web/web_dev/custom;
            index  index.html;
        }
    }

	
	# 三湘门户测试环境
	server {
		listen       8660;
		client_max_body_size 200M;
		 
		access_log  /home/web/sx_test/logs/all.access.log  main;
		
		location / {
            root   /home/web/sx_test/dist;
            index  index.html;
        }
		
		# vueDemo iframe
		 location /vueIframe {
            proxy_pass http://127.0.0.1:8661/;
		 }

		location ~ CIP {
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
			
            proxy_pass http://cip3;
        }		 
	}
	
	# 三湘门户测试环境
    server {
        listen       8661;

        location / {
            root   /home/web/sx_test/vueDemo;
            index  index.html;
        }
    }
	# 天津对公营销环境二期
	server {
		 listen       8550;
		client_max_body_size 200M;
		 
		 access_log  /home/web/web_tj_official2/logs/all.access.log  main;
		 
		# 门户项目
		 location / {
            proxy_pass http://127.0.0.1:8551/;
        }
		
		# 门户项目
		 location /gateway {
            proxy_pass http://127.0.0.1:8551/;
        }
		 
		 # 静态资源
		 location /assets {
			proxy_pass http://127.0.0.1:8552;
		 }
		 
		 # 静态资源
		 location /scripts.js {
			proxy_pass http://127.0.0.1:8552/scripts.js;
		 }
		 
		 # 静态资源
		 location /styles.css {
			proxy_pass http://127.0.0.1:8552/styles.css;
		 }
		
		# 身份认证代理
		 location /basicsIframe {
            proxy_pass http://127.0.0.1:8553/;
        }
		
		# 客户中心
		 location /customIframe {
            proxy_pass http://127.0.0.1:8554/;
        }
		
		# 产品中心
		 location /productIframe {
            proxy_pass http://127.0.0.1:8555/;
        }
		
		# 工作流
		 location /workflowIframe {
            proxy_pass http://127.0.0.1:8556/;
        }
		
		# other [cip 事件中心 消息中心]
		 location /otherIframe {
            proxy_pass http://127.0.0.1:8557/;
        }

		location ~ CIP {
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
			proxy_http_version 1.1;
			
            proxy_pass http://cip5;
        }		 
	}
	
	# 天津对公营销环境二期 门户项目
    server {
        listen       8551;

        access_log  /home/web/web_tj_official2/logs/gateway.access.log  main;

        location / {
            root   /home/web/web_tj_official2/gateway;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 门户静态资源
	server {
		 listen       8552;

		 access_log  /home/web/web_tj_official2/logs/static.access.log  main;

		 location / {
			 root   /home/web/web_tj_official2/static;
		 }
	}
	
	# 天津对公营销环境 身份认证
    server {
        listen       8553;

        access_log  /home/web/web_tj_official2/logs/basics.access.log  main;

        location / {
            root   /home/web/web_tj_official2/basics;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 客户中心
    server {
        listen       8554;

        access_log  /home/web/web_tj_official2/logs/custom.access.log  main;

        location / {
            root   /home/web/web_tj_official2/custom;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 产品中心
    server {
        listen       8555;

        access_log  /home/web/web_tj_official2/logs/product.access.log  main;

        location / {
            root   /home/web/web_tj_official2/product;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 工作流
    server {
        listen       8556;

        access_log  /home/web/web_tj_official2/logs/workflow.access.log  main;

        location / {
            root   /home/web/web_tj_official2/workflow;
            index  index.html;
        }
    }
	
	# 天津对公营销环境 其他【CIP  消息中心 事件中心】
    server {
        listen       8557;

        access_log  /home/web/web_tj_official2/logs/other.access.log  main;

        location / {
            root   /home/web/web_tj_official2/other;
            index  index.html;
        }
    }
	
	# 天津对公二期
	server {
		listen		8888;
		client_max_body_size 200m;
		
		access_log /home/web/web_tj_official2/logs/official.access.log	main;
		
		location / {
			root	/home/web/web_tj_official2/dist;
			client_max_body_size	200m;
			index	index.html;
		}
		
		location ~ CIP {
			add_header 'Access-Control-Allow-Origin' '*';
			add_header 'Access-Control-Allow-Credentials' 'true';
			add_header 'Access-Control-Allow-Methods' 'GET, POST,PUT,DELETE, OPTIONS';
			add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';
			
			proxy_pass	http://cip5;
		}
	}
}

